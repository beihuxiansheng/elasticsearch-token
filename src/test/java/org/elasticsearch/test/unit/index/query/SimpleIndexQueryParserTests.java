begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * Licensed to ElasticSearch and Shay Banon under one  * or more contributor license agreements.  See the NOTICE file  * distributed with this work for additional information  * regarding copyright ownership. ElasticSearch licenses this  * file to you under the Apache License, Version 2.0 (the  * "License"); you may not use this file except in compliance  * with the License.  You may obtain a copy of the License at  *  *    http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing,  * software distributed under the License is distributed on an  * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY  * KIND, either express or implied.  See the License for the  * specific language governing permissions and limitations  * under the License.  */
end_comment

begin_package
DECL|package|org.elasticsearch.test.unit.index.query
package|package
name|org
operator|.
name|elasticsearch
operator|.
name|test
operator|.
name|unit
operator|.
name|index
operator|.
name|query
package|;
end_package

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|index
operator|.
name|Term
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|queries
operator|.
name|BoostingQuery
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|queries
operator|.
name|FilterClause
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|queries
operator|.
name|TermsFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|sandbox
operator|.
name|queries
operator|.
name|FuzzyLikeThisQuery
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|search
operator|.
name|*
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|search
operator|.
name|spans
operator|.
name|*
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|spatial
operator|.
name|prefix
operator|.
name|RecursivePrefixTreeFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|util
operator|.
name|BytesRef
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|lucene
operator|.
name|util
operator|.
name|NumericUtils
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|cluster
operator|.
name|ClusterService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|bytes
operator|.
name|BytesArray
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|inject
operator|.
name|AbstractModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|inject
operator|.
name|Injector
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|inject
operator|.
name|ModulesBuilder
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|inject
operator|.
name|util
operator|.
name|Providers
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|lucene
operator|.
name|search
operator|.
name|*
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|lucene
operator|.
name|search
operator|.
name|function
operator|.
name|BoostScoreFunction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|lucene
operator|.
name|search
operator|.
name|function
operator|.
name|FunctionScoreQuery
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|settings
operator|.
name|ImmutableSettings
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|settings
operator|.
name|Settings
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|settings
operator|.
name|SettingsModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|Index
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|IndexNameModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|analysis
operator|.
name|AnalysisModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|cache
operator|.
name|IndexCacheModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|cache
operator|.
name|filter
operator|.
name|support
operator|.
name|CacheKeyFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|codec
operator|.
name|CodecModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|engine
operator|.
name|IndexEngineModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|mapper
operator|.
name|MapperService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|mapper
operator|.
name|MapperServiceModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|query
operator|.
name|IndexQueryParserModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|query
operator|.
name|IndexQueryParserService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|query
operator|.
name|ParsedQuery
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|search
operator|.
name|NumericRangeFieldDataFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|search
operator|.
name|geo
operator|.
name|GeoDistanceFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|search
operator|.
name|geo
operator|.
name|GeoPolygonFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|search
operator|.
name|geo
operator|.
name|InMemoryGeoBoundingBoxFilter
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|settings
operator|.
name|IndexSettingsModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|similarity
operator|.
name|SimilarityModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|indices
operator|.
name|query
operator|.
name|IndicesQueriesModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|script
operator|.
name|ScriptModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|threadpool
operator|.
name|ThreadPool
import|;
end_import

begin_import
import|import
name|org
operator|.
name|elasticsearch
operator|.
name|threadpool
operator|.
name|ThreadPoolModule
import|;
end_import

begin_import
import|import
name|org
operator|.
name|testng
operator|.
name|annotations
operator|.
name|AfterClass
import|;
end_import

begin_import
import|import
name|org
operator|.
name|testng
operator|.
name|annotations
operator|.
name|BeforeClass
import|;
end_import

begin_import
import|import
name|org
operator|.
name|testng
operator|.
name|annotations
operator|.
name|Test
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|IOException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|lang
operator|.
name|reflect
operator|.
name|Field
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|io
operator|.
name|Streams
operator|.
name|copyToBytesFromClasspath
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|elasticsearch
operator|.
name|common
operator|.
name|io
operator|.
name|Streams
operator|.
name|copyToStringFromClasspath
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|query
operator|.
name|FilterBuilders
operator|.
name|*
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|query
operator|.
name|QueryBuilders
operator|.
name|*
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|elasticsearch
operator|.
name|index
operator|.
name|query
operator|.
name|RegexpFlag
operator|.
name|*
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|hamcrest
operator|.
name|MatcherAssert
operator|.
name|assertThat
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|hamcrest
operator|.
name|Matchers
operator|.
name|*
import|;
end_import

begin_comment
comment|/**  *  */
end_comment

begin_class
annotation|@
name|Test
DECL|class|SimpleIndexQueryParserTests
specifier|public
class|class
name|SimpleIndexQueryParserTests
block|{
DECL|field|injector
specifier|private
name|Injector
name|injector
decl_stmt|;
DECL|field|queryParser
specifier|private
name|IndexQueryParserService
name|queryParser
decl_stmt|;
annotation|@
name|BeforeClass
DECL|method|setupQueryParser
specifier|public
name|void
name|setupQueryParser
parameter_list|()
throws|throws
name|IOException
block|{
name|Settings
name|settings
init|=
name|ImmutableSettings
operator|.
name|settingsBuilder
argument_list|()
operator|.
name|put
argument_list|(
literal|"index.cache.filter.type"
argument_list|,
literal|"none"
argument_list|)
operator|.
name|build
argument_list|()
decl_stmt|;
name|Index
name|index
init|=
operator|new
name|Index
argument_list|(
literal|"test"
argument_list|)
decl_stmt|;
name|injector
operator|=
operator|new
name|ModulesBuilder
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|CodecModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|SettingsModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|ThreadPoolModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|IndicesQueriesModule
argument_list|()
argument_list|,
operator|new
name|ScriptModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|MapperServiceModule
argument_list|()
argument_list|,
operator|new
name|IndexSettingsModule
argument_list|(
name|index
argument_list|,
name|settings
argument_list|)
argument_list|,
operator|new
name|IndexCacheModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|AnalysisModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|IndexEngineModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|SimilarityModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|IndexQueryParserModule
argument_list|(
name|settings
argument_list|)
argument_list|,
operator|new
name|IndexNameModule
argument_list|(
name|index
argument_list|)
argument_list|,
operator|new
name|AbstractModule
argument_list|()
block|{
annotation|@
name|Override
specifier|protected
name|void
name|configure
parameter_list|()
block|{
name|bind
argument_list|(
name|ClusterService
operator|.
name|class
argument_list|)
operator|.
name|toProvider
argument_list|(
name|Providers
operator|.
name|of
argument_list|(
operator|(
name|ClusterService
operator|)
literal|null
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
operator|.
name|createInjector
argument_list|()
expr_stmt|;
name|String
name|mapping
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/mapping.json"
argument_list|)
decl_stmt|;
name|injector
operator|.
name|getInstance
argument_list|(
name|MapperService
operator|.
name|class
argument_list|)
operator|.
name|merge
argument_list|(
literal|"person"
argument_list|,
name|mapping
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|injector
operator|.
name|getInstance
argument_list|(
name|MapperService
operator|.
name|class
argument_list|)
operator|.
name|documentMapper
argument_list|(
literal|"person"
argument_list|)
operator|.
name|parse
argument_list|(
operator|new
name|BytesArray
argument_list|(
name|copyToBytesFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/data.json"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|this
operator|.
name|queryParser
operator|=
name|injector
operator|.
name|getInstance
argument_list|(
name|IndexQueryParserService
operator|.
name|class
argument_list|)
expr_stmt|;
block|}
annotation|@
name|AfterClass
DECL|method|close
specifier|public
name|void
name|close
parameter_list|()
block|{
name|injector
operator|.
name|getInstance
argument_list|(
name|ThreadPool
operator|.
name|class
argument_list|)
operator|.
name|shutdownNow
argument_list|()
expr_stmt|;
block|}
DECL|method|queryParser
specifier|private
name|IndexQueryParserService
name|queryParser
parameter_list|()
throws|throws
name|IOException
block|{
return|return
name|this
operator|.
name|queryParser
return|;
block|}
DECL|method|longToPrefixCoded
specifier|private
name|BytesRef
name|longToPrefixCoded
parameter_list|(
name|long
name|val
parameter_list|)
block|{
name|BytesRef
name|bytesRef
init|=
operator|new
name|BytesRef
argument_list|()
decl_stmt|;
name|NumericUtils
operator|.
name|longToPrefixCoded
argument_list|(
name|val
argument_list|,
name|NumericUtils
operator|.
name|PRECISION_STEP_DEFAULT
argument_list|,
name|bytesRef
argument_list|)
expr_stmt|;
return|return
name|bytesRef
return|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringBuilder
specifier|public
name|void
name|testQueryStringBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|queryString
argument_list|(
literal|"test"
argument_list|)
operator|.
name|defaultField
argument_list|(
literal|"content"
argument_list|)
operator|.
name|phraseSlop
argument_list|(
literal|1
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermQuery
name|termQuery
init|=
operator|(
name|TermQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|termQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryString
specifier|public
name|void
name|testQueryString
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermQuery
name|termQuery
init|=
operator|(
name|TermQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|termQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFields1Builder
specifier|public
name|void
name|testQueryStringFields1Builder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|queryString
argument_list|(
literal|"test"
argument_list|)
operator|.
name|field
argument_list|(
literal|"content"
argument_list|)
operator|.
name|field
argument_list|(
literal|"name"
argument_list|)
operator|.
name|useDisMax
argument_list|(
literal|false
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|bQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFields1
specifier|public
name|void
name|testQueryStringFields1
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query-fields1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|bQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFieldsMatch
specifier|public
name|void
name|testQueryStringFieldsMatch
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query-fields-match.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|bQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|clauses
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFields2Builder
specifier|public
name|void
name|testQueryStringFields2Builder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|queryString
argument_list|(
literal|"test"
argument_list|)
operator|.
name|field
argument_list|(
literal|"content"
argument_list|)
operator|.
name|field
argument_list|(
literal|"name"
argument_list|)
operator|.
name|useDisMax
argument_list|(
literal|true
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFields2
specifier|public
name|void
name|testQueryStringFields2
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query-fields2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFields3Builder
specifier|public
name|void
name|testQueryStringFields3Builder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|queryString
argument_list|(
literal|"test"
argument_list|)
operator|.
name|field
argument_list|(
literal|"content"
argument_list|,
literal|2.2f
argument_list|)
operator|.
name|field
argument_list|(
literal|"name"
argument_list|)
operator|.
name|useDisMax
argument_list|(
literal|true
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.2
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFields3
specifier|public
name|void
name|testQueryStringFields3
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query-fields3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.2
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMatchAllBuilder
specifier|public
name|void
name|testMatchAllBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|matchAllQuery
argument_list|()
operator|.
name|boost
argument_list|(
literal|1.2f
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MatchAllDocsQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MatchAllDocsQuery
name|matchAllDocsQuery
init|=
operator|(
name|MatchAllDocsQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|matchAllDocsQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMatchAll
specifier|public
name|void
name|testMatchAll
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/matchAll.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MatchAllDocsQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MatchAllDocsQuery
name|matchAllDocsQuery
init|=
operator|(
name|MatchAllDocsQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|matchAllDocsQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMatchAllEmpty1
specifier|public
name|void
name|testMatchAllEmpty1
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/match_all_empty1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|sameInstance
argument_list|(
name|Queries
operator|.
name|MATCH_ALL_QUERY
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMatchAllEmpty2
specifier|public
name|void
name|testMatchAllEmpty2
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/match_all_empty2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|sameInstance
argument_list|(
name|Queries
operator|.
name|MATCH_ALL_QUERY
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testStarColonStar
specifier|public
name|void
name|testStarColonStar
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/starColonStar.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|ConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|ConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|ConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|Filter
name|internalFilter
init|=
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|internalFilter
argument_list|,
name|instanceOf
argument_list|(
name|MatchAllDocsFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testDisMaxBuilder
specifier|public
name|void
name|testDisMaxBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|disMaxQuery
argument_list|()
operator|.
name|boost
argument_list|(
literal|1.2f
argument_list|)
operator|.
name|tieBreaker
argument_list|(
literal|0.7f
argument_list|)
operator|.
name|add
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"first"
argument_list|)
argument_list|)
operator|.
name|add
argument_list|(
name|termQuery
argument_list|(
literal|"name.last"
argument_list|,
literal|"last"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disjunctionMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|disjunctionMaxQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disjunctionMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|disjuncts
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|Query
name|firstQ
init|=
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|firstQ
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|firstQ
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"first"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|Query
name|secondsQ
init|=
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|secondsQ
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|secondsQ
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"last"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testDisMax
specifier|public
name|void
name|testDisMax
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/disMax.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disjunctionMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|disjunctionMaxQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disjunctionMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|disjuncts
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|Query
name|firstQ
init|=
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|firstQ
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|firstQ
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"first"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|Query
name|secondsQ
init|=
name|disjuncts
operator|.
name|get
argument_list|(
literal|1
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|secondsQ
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|secondsQ
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"last"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testDisMax2
specifier|public
name|void
name|testDisMax2
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/disMax2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|DisjunctionMaxQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|DisjunctionMaxQuery
name|disjunctionMaxQuery
init|=
operator|(
name|DisjunctionMaxQuery
operator|)
name|parsedQuery
decl_stmt|;
name|List
argument_list|<
name|Query
argument_list|>
name|disjuncts
init|=
name|Queries
operator|.
name|disMaxClauses
argument_list|(
name|disjunctionMaxQuery
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|disjuncts
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|firstQ
init|=
operator|(
name|PrefixQuery
operator|)
name|disjuncts
operator|.
name|get
argument_list|(
literal|0
argument_list|)
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|firstQ
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|firstQ
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermQueryBuilder
specifier|public
name|void
name|testTermQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|termQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
operator|.
name|buildAsBytes
argument_list|()
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermQuery
specifier|public
name|void
name|testTermQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/term.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFuzzyQueryBuilder
specifier|public
name|void
name|testFuzzyQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|fuzzyQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
operator|.
name|buildAsBytes
argument_list|()
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|FuzzyQuery
name|fuzzyQuery
init|=
operator|(
name|FuzzyQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFuzzyQuery
specifier|public
name|void
name|testFuzzyQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/fuzzy.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|FuzzyQuery
name|fuzzyQuery
init|=
operator|(
name|FuzzyQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFuzzyQueryWithFieldsBuilder
specifier|public
name|void
name|testFuzzyQueryWithFieldsBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|fuzzyQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
operator|.
name|minSimilarity
argument_list|(
literal|0.1f
argument_list|)
operator|.
name|prefixLength
argument_list|(
literal|1
argument_list|)
operator|.
name|boost
argument_list|(
literal|2.0f
argument_list|)
operator|.
name|buildAsBytes
argument_list|()
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|FuzzyQuery
name|fuzzyQuery
init|=
operator|(
name|FuzzyQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getMaxEdits
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|FuzzyQuery
operator|.
name|floatToEdits
argument_list|(
literal|0.1f
argument_list|,
literal|"sh"
operator|.
name|length
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getPrefixLength
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2.0f
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFuzzyQueryWithFields
specifier|public
name|void
name|testFuzzyQueryWithFields
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/fuzzy-with-fields.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|FuzzyQuery
name|fuzzyQuery
init|=
operator|(
name|FuzzyQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getMaxEdits
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|FuzzyQuery
operator|.
name|floatToEdits
argument_list|(
literal|0.1f
argument_list|,
literal|"sh"
operator|.
name|length
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getPrefixLength
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2.0f
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFuzzyQueryWithFields2
specifier|public
name|void
name|testFuzzyQueryWithFields2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/fuzzy-with-fields2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fuzzyQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getMin
argument_list|()
operator|.
name|longValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|7l
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getMax
argument_list|()
operator|.
name|longValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|17l
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFieldQueryBuilder1
specifier|public
name|void
name|testFieldQueryBuilder1
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|fieldQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
operator|.
name|buildAsBytes
argument_list|()
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFieldQuery1
specifier|public
name|void
name|testFieldQuery1
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/field1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFieldQuery2
specifier|public
name|void
name|testFieldQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/field2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|bQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|bQuery
operator|.
name|getClauses
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
operator|.
name|text
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"something"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|bQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
operator|.
name|text
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"else"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFieldQuery3
specifier|public
name|void
name|testFieldQuery3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/field3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|parsedQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.0
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTextQuery1
specifier|public
name|void
name|testTextQuery1
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/text1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|booleanQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|booleanQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.0d
argument_list|,
literal|0.00001d
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|booleanQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"aaa"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|booleanQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"bbb"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTextQuery2
specifier|public
name|void
name|testTextQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/text2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|booleanQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|booleanQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.5d
argument_list|,
literal|0.00001d
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|booleanQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"aaa"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|booleanQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"bbb"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTextQuery3
specifier|public
name|void
name|testTextQuery3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/text3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PhraseQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PhraseQuery
name|phraseQuery
init|=
operator|(
name|PhraseQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|phraseQuery
operator|.
name|getTerms
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"aaa"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|phraseQuery
operator|.
name|getTerms
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"bbb"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTextQuery4
specifier|public
name|void
name|testTextQuery4
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/text4.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MultiPhrasePrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MultiPhrasePrefixQuery
name|phraseQuery
init|=
operator|(
name|MultiPhrasePrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|phraseQuery
operator|.
name|getTermArrays
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"aaa"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|phraseQuery
operator|.
name|getTermArrays
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"bbb"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTextQuery4_2
specifier|public
name|void
name|testTextQuery4_2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/text4_2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MultiPhrasePrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MultiPhrasePrefixQuery
name|phraseQuery
init|=
operator|(
name|MultiPhrasePrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|phraseQuery
operator|.
name|getTermArrays
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"aaa"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|phraseQuery
operator|.
name|getTermArrays
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"bbb"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermWithBoostQueryBuilder
specifier|public
name|void
name|testTermWithBoostQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|termQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
operator|.
name|boost
argument_list|(
literal|2.0f
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|fieldQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.0
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermWithBoostQuery
specifier|public
name|void
name|testTermWithBoostQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/term-with-boost.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fieldQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|34
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fieldQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|fieldQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.0
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixQueryBuilder
specifier|public
name|void
name|testPrefixQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|prefixQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|prefixQuery
init|=
operator|(
name|PrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixQuery
specifier|public
name|void
name|testPrefixQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/prefix.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|prefixQuery
init|=
operator|(
name|PrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixBoostQuery
specifier|public
name|void
name|testPrefixBoostQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/prefix-boost.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|prefixQuery
init|=
operator|(
name|PrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|prefixQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixFilteredQueryBuilder
specifier|public
name|void
name|testPrefixFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|prefixFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|PrefixFilter
name|prefixFilter
init|=
operator|(
name|PrefixFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|prefixFilter
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixFilteredQuery
specifier|public
name|void
name|testPrefixFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/prefix-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|PrefixFilter
name|prefixFilter
init|=
operator|(
name|PrefixFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|prefixFilter
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixNamedFilteredQuery
specifier|public
name|void
name|testPrefixNamedFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/prefix-filter-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|PrefixFilter
name|prefixFilter
init|=
operator|(
name|PrefixFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|prefixFilter
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixQueryBoostQueryBuilder
specifier|public
name|void
name|testPrefixQueryBoostQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|prefixQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
operator|.
name|boost
argument_list|(
literal|2.0f
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|prefixQuery
init|=
operator|(
name|PrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|prefixQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.0
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixQueryBoostQuery
specifier|public
name|void
name|testPrefixQueryBoostQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/prefix-with-boost.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|prefixQuery
init|=
operator|(
name|PrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|prefixQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|2.0
argument_list|,
literal|0.01
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testPrefixQueryWithUnknownField
specifier|public
name|void
name|testPrefixQueryWithUnknownField
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|prefixQuery
argument_list|(
literal|"unknown"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|PrefixQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|PrefixQuery
name|prefixQuery
init|=
operator|(
name|PrefixQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getPrefix
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"unknown"
argument_list|,
literal|"sh"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|prefixQuery
operator|.
name|getRewriteMethod
argument_list|()
argument_list|,
name|notNullValue
argument_list|()
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRegexpQueryBuilder
specifier|public
name|void
name|testRegexpQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|regexpQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"s.*y"
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|RegexpQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpQuery
name|regexpQuery
init|=
operator|(
name|RegexpQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|regexpQuery
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRegexpQuery
specifier|public
name|void
name|testRegexpQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/regexp.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|RegexpQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpQuery
name|regexpQuery
init|=
operator|(
name|RegexpQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|regexpQuery
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRegexpFilteredQuery
specifier|public
name|void
name|testRegexpFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/regexp-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|RegexpFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpFilter
name|regexpFilter
init|=
operator|(
name|RegexpFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|regexp
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"s.*y"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNamedRegexpFilteredQuery
specifier|public
name|void
name|testNamedRegexpFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/regexp-filter-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|RegexpFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpFilter
name|regexpFilter
init|=
operator|(
name|RegexpFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|regexp
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"s.*y"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRegexpWithFlagsFilteredQuery
specifier|public
name|void
name|testRegexpWithFlagsFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/regexp-filter-flags.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|RegexpFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpFilter
name|regexpFilter
init|=
operator|(
name|RegexpFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|regexp
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"s.*y"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|flags
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|INTERSECTION
operator|.
name|value
argument_list|()
operator||
name|COMPLEMENT
operator|.
name|value
argument_list|()
operator||
name|EMPTY
operator|.
name|value
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNamedAndCachedRegexpWithFlagsFilteredQuery
specifier|public
name|void
name|testNamedAndCachedRegexpWithFlagsFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/regexp-filter-flags-named-cached.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|CacheKeyFilter
operator|.
name|Wrapper
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|CacheKeyFilter
operator|.
name|Wrapper
name|wrapper
init|=
operator|(
name|CacheKeyFilter
operator|.
name|Wrapper
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|wrapper
operator|.
name|cacheKey
argument_list|()
operator|.
name|utf8ToString
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"key"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|wrapper
operator|.
name|wrappedFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|RegexpFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpFilter
name|regexpFilter
init|=
operator|(
name|RegexpFilter
operator|)
name|wrapper
operator|.
name|wrappedFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|regexp
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"s.*y"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpFilter
operator|.
name|flags
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|INTERSECTION
operator|.
name|value
argument_list|()
operator||
name|COMPLEMENT
operator|.
name|value
argument_list|()
operator||
name|EMPTY
operator|.
name|value
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRegexpBoostQuery
specifier|public
name|void
name|testRegexpBoostQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/regexp-boost.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|RegexpQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|RegexpQuery
name|regexpQuery
init|=
operator|(
name|RegexpQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|regexpQuery
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|regexpQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1.2f
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testWildcardQueryBuilder
specifier|public
name|void
name|testWildcardQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|wildcardQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh*"
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|WildcardQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|WildcardQuery
name|wildcardQuery
init|=
operator|(
name|WildcardQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|wildcardQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh*"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testWildcardQuery
specifier|public
name|void
name|testWildcardQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/wildcard.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|WildcardQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|WildcardQuery
name|wildcardQuery
init|=
operator|(
name|WildcardQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|wildcardQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh*"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testWildcardBoostQuery
specifier|public
name|void
name|testWildcardBoostQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/wildcard-boost.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|WildcardQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|WildcardQuery
name|wildcardQuery
init|=
operator|(
name|WildcardQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|wildcardQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh*"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|wildcardQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.2
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRangeQueryBuilder
specifier|public
name|void
name|testRangeQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|rangeQuery
argument_list|(
literal|"age"
argument_list|)
operator|.
name|from
argument_list|(
literal|23
argument_list|)
operator|.
name|to
argument_list|(
literal|54
argument_list|)
operator|.
name|includeLower
argument_list|(
literal|true
argument_list|)
operator|.
name|includeUpper
argument_list|(
literal|false
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|rangeQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRangeQuery
specifier|public
name|void
name|testRangeQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/range.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|rangeQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRange2Query
specifier|public
name|void
name|testRange2Query
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/range2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|rangeQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeQuery
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRangeFilteredQueryBuilder
specifier|public
name|void
name|testRangeFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|rangeFilter
argument_list|(
literal|"age"
argument_list|)
operator|.
name|from
argument_list|(
literal|23
argument_list|)
operator|.
name|to
argument_list|(
literal|54
argument_list|)
operator|.
name|includeLower
argument_list|(
literal|true
argument_list|)
operator|.
name|includeUpper
argument_list|(
literal|false
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeFilter
name|rangeFilter
init|=
operator|(
name|NumericRangeFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRangeFilteredQuery
specifier|public
name|void
name|testRangeFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/range-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeFilter
name|rangeFilter
init|=
operator|(
name|NumericRangeFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testRangeNamedFilteredQuery
specifier|public
name|void
name|testRangeNamedFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/range-filter-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeFilter
name|rangeFilter
init|=
operator|(
name|NumericRangeFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|includesMin
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|includesMax
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNumericRangeFilteredQueryBuilder
specifier|public
name|void
name|testNumericRangeFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|numericRangeFilter
argument_list|(
literal|"age"
argument_list|)
operator|.
name|from
argument_list|(
literal|23
argument_list|)
operator|.
name|to
argument_list|(
literal|54
argument_list|)
operator|.
name|includeLower
argument_list|(
literal|true
argument_list|)
operator|.
name|includeUpper
argument_list|(
literal|false
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeFieldDataFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeFieldDataFilter
argument_list|<
name|Number
argument_list|>
name|rangeFilter
init|=
operator|(
name|NumericRangeFieldDataFilter
argument_list|<
name|Number
argument_list|>
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getLowerVal
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getUpperVal
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|isIncludeLower
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|isIncludeUpper
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNumericRangeFilteredQuery
specifier|public
name|void
name|testNumericRangeFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/numeric_range-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
operator|(
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|)
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeFieldDataFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeFieldDataFilter
argument_list|<
name|Number
argument_list|>
name|rangeFilter
init|=
operator|(
name|NumericRangeFieldDataFilter
argument_list|<
name|Number
argument_list|>
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getLowerVal
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getUpperVal
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|isIncludeLower
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|isIncludeUpper
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testBoolFilteredQueryBuilder
specifier|public
name|void
name|testBoolFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|boolFilter
argument_list|()
operator|.
name|must
argument_list|(
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|,
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
operator|.
name|mustNot
argument_list|(
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay2"
argument_list|)
argument_list|)
operator|.
name|should
argument_list|(
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay3"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|XBooleanFilter
name|booleanFilter
init|=
operator|(
name|XBooleanFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|Iterator
argument_list|<
name|FilterClause
argument_list|>
name|iterator
init|=
name|booleanFilter
operator|.
name|iterator
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|FilterClause
name|clause
init|=
name|iterator
operator|.
name|next
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|clause
operator|=
name|iterator
operator|.
name|next
argument_list|()
expr_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|clause
operator|=
name|iterator
operator|.
name|next
argument_list|()
expr_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST_NOT
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay2"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|clause
operator|=
name|iterator
operator|.
name|next
argument_list|()
expr_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|SHOULD
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay3"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testBoolFilteredQuery
specifier|public
name|void
name|testBoolFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/bool-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|XBooleanFilter
name|booleanFilter
init|=
operator|(
name|XBooleanFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|Iterator
argument_list|<
name|FilterClause
argument_list|>
name|iterator
init|=
name|booleanFilter
operator|.
name|iterator
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|FilterClause
name|clause
init|=
name|iterator
operator|.
name|next
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|clause
operator|=
name|iterator
operator|.
name|next
argument_list|()
expr_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|clause
operator|=
name|iterator
operator|.
name|next
argument_list|()
expr_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST_NOT
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay2"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|clause
operator|=
name|iterator
operator|.
name|next
argument_list|()
expr_stmt|;
name|assertThat
argument_list|(
name|clause
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|SHOULD
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|clause
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay3"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|iterator
operator|.
name|hasNext
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testAndFilteredQueryBuilder
specifier|public
name|void
name|testAndFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|matchAllQuery
argument_list|()
argument_list|,
name|andFilter
argument_list|(
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|,
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|AndFilter
name|andFilter
init|=
operator|(
name|AndFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testAndFilteredQuery
specifier|public
name|void
name|testAndFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/and-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|AndFilter
name|andFilter
init|=
operator|(
name|AndFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testAndNamedFilteredQuery
specifier|public
name|void
name|testAndNamedFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/and-filter-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|AndFilter
name|andFilter
init|=
operator|(
name|AndFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testAndFilteredQuery2
specifier|public
name|void
name|testAndFilteredQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/and-filter2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|AndFilter
name|andFilter
init|=
operator|(
name|AndFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testOrFilteredQueryBuilder
specifier|public
name|void
name|testOrFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|matchAllQuery
argument_list|()
argument_list|,
name|orFilter
argument_list|(
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|,
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|OrFilter
name|andFilter
init|=
operator|(
name|OrFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|andFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testOrFilteredQuery
specifier|public
name|void
name|testOrFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/or-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|OrFilter
name|orFilter
init|=
operator|(
name|OrFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|orFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|orFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|orFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testOrFilteredQuery2
specifier|public
name|void
name|testOrFilteredQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/or-filter2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|OrFilter
name|orFilter
init|=
operator|(
name|OrFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|orFilter
operator|.
name|filters
argument_list|()
operator|.
name|size
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|orFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|orFilter
operator|.
name|filters
argument_list|()
operator|.
name|get
argument_list|(
literal|1
argument_list|)
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNotFilteredQueryBuilder
specifier|public
name|void
name|testNotFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|matchAllQuery
argument_list|()
argument_list|,
name|notFilter
argument_list|(
name|termFilter
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|NotFilter
name|notFilter
init|=
operator|(
name|NotFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|notFilter
operator|.
name|filter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNotFilteredQuery
specifier|public
name|void
name|testNotFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/not-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|NotFilter
name|notFilter
init|=
operator|(
name|NotFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|notFilter
operator|.
name|filter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNotFilteredQuery2
specifier|public
name|void
name|testNotFilteredQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/not-filter2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|NotFilter
name|notFilter
init|=
operator|(
name|NotFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|notFilter
operator|.
name|filter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testNotFilteredQuery3
specifier|public
name|void
name|testNotFilteredQuery3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/not-filter3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|NotFilter
name|notFilter
init|=
operator|(
name|NotFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|notFilter
operator|.
name|filter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testBoostingQueryBuilder
specifier|public
name|void
name|testBoostingQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|boostingQuery
argument_list|()
operator|.
name|positive
argument_list|(
name|termQuery
argument_list|(
literal|"field1"
argument_list|,
literal|"value1"
argument_list|)
argument_list|)
operator|.
name|negative
argument_list|(
name|termQuery
argument_list|(
literal|"field1"
argument_list|,
literal|"value2"
argument_list|)
argument_list|)
operator|.
name|negativeBoost
argument_list|(
literal|0.2f
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BoostingQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testBoostingQuery
specifier|public
name|void
name|testBoostingQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/boosting-query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BoostingQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryStringFuzzyNumeric
specifier|public
name|void
name|testQueryStringFuzzyNumeric
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeQuery
name|fuzzyQuery
init|=
operator|(
name|NumericRangeQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getMin
argument_list|()
operator|.
name|longValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12l
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|fuzzyQuery
operator|.
name|getMax
argument_list|()
operator|.
name|longValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12l
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testBoolQueryBuilder
specifier|public
name|void
name|testBoolQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|boolQuery
argument_list|()
operator|.
name|must
argument_list|(
name|termQuery
argument_list|(
literal|"content"
argument_list|,
literal|"test1"
argument_list|)
argument_list|)
operator|.
name|must
argument_list|(
name|termQuery
argument_list|(
literal|"content"
argument_list|,
literal|"test4"
argument_list|)
argument_list|)
operator|.
name|mustNot
argument_list|(
name|termQuery
argument_list|(
literal|"content"
argument_list|,
literal|"test2"
argument_list|)
argument_list|)
operator|.
name|should
argument_list|(
name|termQuery
argument_list|(
literal|"content"
argument_list|,
literal|"test3"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|booleanQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|BooleanClause
index|[]
name|clauses
init|=
name|booleanQuery
operator|.
name|getClauses
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|clauses
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|4
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|0
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|1
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|2
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test2"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|2
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST_NOT
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|3
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test3"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|3
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|SHOULD
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testBoolQuery
specifier|public
name|void
name|testBoolQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/bool.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|booleanQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|BooleanClause
index|[]
name|clauses
init|=
name|booleanQuery
operator|.
name|getClauses
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|clauses
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|4
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test1"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|0
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test4"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|1
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|2
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test2"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|2
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|MUST_NOT
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|3
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"content"
argument_list|,
literal|"test3"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|3
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|SHOULD
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermsQuery
specifier|public
name|void
name|testTermsQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/terms-query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|BooleanQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|BooleanQuery
name|booleanQuery
init|=
operator|(
name|BooleanQuery
operator|)
name|parsedQuery
decl_stmt|;
name|BooleanClause
index|[]
name|clauses
init|=
name|booleanQuery
operator|.
name|getClauses
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|clauses
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|0
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|0
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|SHOULD
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|clauses
index|[
literal|1
index|]
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"test"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|clauses
index|[
literal|1
index|]
operator|.
name|getOccur
argument_list|()
argument_list|,
name|equalTo
argument_list|(
name|BooleanClause
operator|.
name|Occur
operator|.
name|SHOULD
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFilteredQueryBuilder
specifier|public
name|void
name|testFilteredQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|termFilter
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFilteredQuery
specifier|public
name|void
name|testFilteredQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/filtered-query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFilteredQuery2
specifier|public
name|void
name|testFilteredQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/filtered-query2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFilteredQuery3
specifier|public
name|void
name|testFilteredQuery3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/filtered-query3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|Filter
name|filter
init|=
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
argument_list|,
name|instanceOf
argument_list|(
name|NumericRangeFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|NumericRangeFilter
name|rangeFilter
init|=
operator|(
name|NumericRangeFilter
operator|)
name|filter
decl_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getField
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"age"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMin
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|23
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|rangeFilter
operator|.
name|getMax
argument_list|()
operator|.
name|intValue
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|54
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFilteredQuery4
specifier|public
name|void
name|testFilteredQuery4
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/filtered-query4.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|WildcardQuery
name|wildcardQuery
init|=
operator|(
name|WildcardQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|wildcardQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"sh*"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
name|double
operator|)
name|wildcardQuery
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.1
argument_list|,
literal|0.001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testLimitFilter
specifier|public
name|void
name|testLimitFilter
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/limit-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|LimitFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|LimitFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getLimit
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getQuery
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|filteredQuery
operator|.
name|getQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermFilterQuery
specifier|public
name|void
name|testTermFilterQuery
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/term-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|TermFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermFilter
name|termFilter
init|=
operator|(
name|TermFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|termFilter
operator|.
name|getTerm
argument_list|()
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.last"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|termFilter
operator|.
name|getTerm
argument_list|()
operator|.
name|text
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"banon"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermNamedFilterQuery
specifier|public
name|void
name|testTermNamedFilterQuery
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/term-filter-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|TermFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermFilter
name|termFilter
init|=
operator|(
name|TermFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|termFilter
operator|.
name|getTerm
argument_list|()
operator|.
name|field
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"name.last"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|termFilter
operator|.
name|getTerm
argument_list|()
operator|.
name|text
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"banon"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testTermsFilterQueryBuilder
specifier|public
name|void
name|testTermsFilterQueryBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|termsFilter
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|,
literal|"kimchy"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|TermsFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermsFilter
name|termsFilter
init|=
operator|(
name|TermsFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
comment|//assertThat(termsFilter.getTerms().length, equalTo(2));
comment|//assertThat(termsFilter.getTerms()[0].text(), equalTo("banon"));
block|}
annotation|@
name|Test
DECL|method|testTermsFilterQuery
specifier|public
name|void
name|testTermsFilterQuery
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/terms-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|TermsFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermsFilter
name|termsFilter
init|=
operator|(
name|TermsFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
comment|//assertThat(termsFilter.getTerms().length, equalTo(2));
comment|//assertThat(termsFilter.getTerms()[0].text(), equalTo("banon"));
block|}
annotation|@
name|Test
DECL|method|testTermsWithNameFilterQuery
specifier|public
name|void
name|testTermsWithNameFilterQuery
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/terms-filter-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filteredQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|TermsFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|TermsFilter
name|termsFilter
init|=
operator|(
name|TermsFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
comment|//assertThat(termsFilter.getTerms().length, equalTo(2));
comment|//assertThat(termsFilter.getTerms()[0].text(), equalTo("banon"));
block|}
annotation|@
name|Test
DECL|method|testConstantScoreQueryBuilder
specifier|public
name|void
name|testConstantScoreQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|constantScoreQuery
argument_list|(
name|termFilter
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testConstantScoreQuery
specifier|public
name|void
name|testConstantScoreQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/constantScore-query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|// Disabled since we need a current context to execute it...
comment|//    @Test public void testCustomScoreQuery1() throws IOException {
comment|//        IndexQueryParser queryParser = queryParser();
comment|//        String query = copyToStringFromClasspath("/org/elasticsearch/index/query/custom_score1.json");
comment|//        Query parsedQuery = queryParser.parse(query).query();
comment|//        assertThat(parsedQuery, instanceOf(FunctionScoreQuery.class));
comment|//        FunctionScoreQuery functionScoreQuery = (FunctionScoreQuery) parsedQuery;
comment|//        assertThat(((TermQuery) functionScoreQuery.getSubQuery()).getTerm(), equalTo(new Term("name.last", "banon")));
comment|//        assertThat(functionScoreQuery.getFunction(), instanceOf(CustomScoreQueryParser.ScriptScoreFunction.class));
comment|//    }
annotation|@
name|Test
DECL|method|testCustomBoostFactorQueryBuilder
specifier|public
name|void
name|testCustomBoostFactorQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|customBoostFactorQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
operator|.
name|boostFactor
argument_list|(
literal|1.3f
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FunctionScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|FunctionScoreQuery
name|functionScoreQuery
init|=
operator|(
name|FunctionScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|functionScoreQuery
operator|.
name|getSubQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
call|(
name|double
call|)
argument_list|(
operator|(
name|BoostScoreFunction
operator|)
name|functionScoreQuery
operator|.
name|getFunction
argument_list|()
argument_list|)
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.3
argument_list|,
literal|0.001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testCustomBoostFactorQuery
specifier|public
name|void
name|testCustomBoostFactorQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/custom-boost-factor-query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FunctionScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|FunctionScoreQuery
name|functionScoreQuery
init|=
operator|(
name|FunctionScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|functionScoreQuery
operator|.
name|getSubQuery
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
call|(
name|double
call|)
argument_list|(
operator|(
name|BoostScoreFunction
operator|)
name|functionScoreQuery
operator|.
name|getFunction
argument_list|()
argument_list|)
operator|.
name|getBoost
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|1.3
argument_list|,
literal|0.001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanTermQueryBuilder
specifier|public
name|void
name|testSpanTermQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanTermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanTermQuery
name|termQuery
init|=
operator|(
name|SpanTermQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|termQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanTermQuery
specifier|public
name|void
name|testSpanTermQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/spanTerm.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanTermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanTermQuery
name|termQuery
init|=
operator|(
name|SpanTermQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
name|termQuery
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanNotQueryBuilder
specifier|public
name|void
name|testSpanNotQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|spanNotQuery
argument_list|()
operator|.
name|include
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
argument_list|)
operator|.
name|exclude
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|35
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanNotQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanNotQuery
name|spanNotQuery
init|=
operator|(
name|SpanNotQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNotQuery
operator|.
name|getInclude
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNotQuery
operator|.
name|getExclude
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanNotQuery
specifier|public
name|void
name|testSpanNotQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/spanNot.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanNotQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanNotQuery
name|spanNotQuery
init|=
operator|(
name|SpanNotQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNotQuery
operator|.
name|getInclude
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNotQuery
operator|.
name|getExclude
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanFirstQueryBuilder
specifier|public
name|void
name|testSpanFirstQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|spanFirstQuery
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
argument_list|,
literal|12
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanFirstQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanFirstQuery
name|spanFirstQuery
init|=
operator|(
name|SpanFirstQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanFirstQuery
operator|.
name|getMatch
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|spanFirstQuery
operator|.
name|getEnd
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanFirstQuery
specifier|public
name|void
name|testSpanFirstQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/spanFirst.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanFirstQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanFirstQuery
name|spanFirstQuery
init|=
operator|(
name|SpanFirstQuery
operator|)
name|parsedQuery
decl_stmt|;
comment|// since age is automatically registered in data, we encode it as numeric
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanFirstQuery
operator|.
name|getMatch
argument_list|()
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|spanFirstQuery
operator|.
name|getEnd
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanNearQueryBuilder
specifier|public
name|void
name|testSpanNearQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|spanNearQuery
argument_list|()
operator|.
name|clause
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
argument_list|)
operator|.
name|clause
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|35
argument_list|)
argument_list|)
operator|.
name|clause
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|36
argument_list|)
argument_list|)
operator|.
name|slop
argument_list|(
literal|12
argument_list|)
operator|.
name|inOrder
argument_list|(
literal|false
argument_list|)
operator|.
name|collectPayloads
argument_list|(
literal|false
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanNearQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanNearQuery
name|spanNearQuery
init|=
operator|(
name|SpanNearQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|2
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|36
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|spanNearQuery
operator|.
name|isInOrder
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanNearQuery
specifier|public
name|void
name|testSpanNearQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/spanNear.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanNearQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanNearQuery
name|spanNearQuery
init|=
operator|(
name|SpanNearQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanNearQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|2
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|36
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|spanNearQuery
operator|.
name|isInOrder
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|false
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanOrQueryBuilder
specifier|public
name|void
name|testSpanOrQueryBuilder
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|spanOrQuery
argument_list|()
operator|.
name|clause
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|34
argument_list|)
argument_list|)
operator|.
name|clause
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|35
argument_list|)
argument_list|)
operator|.
name|clause
argument_list|(
name|spanTermQuery
argument_list|(
literal|"age"
argument_list|,
literal|36
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanOrQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanOrQuery
name|spanOrQuery
init|=
operator|(
name|SpanOrQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|2
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|36
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanOrQuery
specifier|public
name|void
name|testSpanOrQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/spanOr.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanOrQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanOrQuery
name|spanOrQuery
init|=
operator|(
name|SpanOrQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|2
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|36
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testSpanOrQuery2
specifier|public
name|void
name|testSpanOrQuery2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/spanOr2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|SpanOrQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|SpanOrQuery
name|spanOrQuery
init|=
operator|(
name|SpanOrQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|0
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|34
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|1
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|35
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|SpanTermQuery
operator|)
name|spanOrQuery
operator|.
name|getClauses
argument_list|()
index|[
literal|2
index|]
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"age"
argument_list|,
name|longToPrefixCoded
argument_list|(
literal|36
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryFilterBuilder
specifier|public
name|void
name|testQueryFilterBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|filteredQuery
argument_list|(
name|termQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"shay"
argument_list|)
argument_list|,
name|queryFilter
argument_list|(
name|termQuery
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|QueryWrapperFilter
name|queryWrapperFilter
init|=
operator|(
name|QueryWrapperFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|Field
name|field
init|=
name|QueryWrapperFilter
operator|.
name|class
operator|.
name|getDeclaredField
argument_list|(
literal|"query"
argument_list|)
decl_stmt|;
name|field
operator|.
name|setAccessible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|Query
name|wrappedQuery
init|=
operator|(
name|Query
operator|)
name|field
operator|.
name|get
argument_list|(
name|queryWrapperFilter
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|wrappedQuery
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|wrappedQuery
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testQueryFilter
specifier|public
name|void
name|testQueryFilter
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/query-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
decl_stmt|;
name|QueryWrapperFilter
name|queryWrapperFilter
init|=
operator|(
name|QueryWrapperFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|Field
name|field
init|=
name|QueryWrapperFilter
operator|.
name|class
operator|.
name|getDeclaredField
argument_list|(
literal|"query"
argument_list|)
decl_stmt|;
name|field
operator|.
name|setAccessible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|Query
name|wrappedQuery
init|=
operator|(
name|Query
operator|)
name|field
operator|.
name|get
argument_list|(
name|queryWrapperFilter
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|wrappedQuery
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|wrappedQuery
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFQueryFilter
specifier|public
name|void
name|testFQueryFilter
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/fquery-filter.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XFilteredQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XFilteredQuery
name|filteredQuery
init|=
operator|(
name|XFilteredQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|QueryWrapperFilter
name|queryWrapperFilter
init|=
operator|(
name|QueryWrapperFilter
operator|)
name|filteredQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|Field
name|field
init|=
name|QueryWrapperFilter
operator|.
name|class
operator|.
name|getDeclaredField
argument_list|(
literal|"query"
argument_list|)
decl_stmt|;
name|field
operator|.
name|setAccessible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|Query
name|wrappedQuery
init|=
operator|(
name|Query
operator|)
name|field
operator|.
name|get
argument_list|(
name|queryWrapperFilter
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|wrappedQuery
argument_list|,
name|instanceOf
argument_list|(
name|TermQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
operator|(
operator|(
name|TermQuery
operator|)
name|wrappedQuery
operator|)
operator|.
name|getTerm
argument_list|()
argument_list|,
name|equalTo
argument_list|(
operator|new
name|Term
argument_list|(
literal|"name.last"
argument_list|,
literal|"banon"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMoreLikeThisBuilder
specifier|public
name|void
name|testMoreLikeThisBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|moreLikeThisQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"name.last"
argument_list|)
operator|.
name|likeText
argument_list|(
literal|"something"
argument_list|)
operator|.
name|minTermFreq
argument_list|(
literal|1
argument_list|)
operator|.
name|maxQueryTerms
argument_list|(
literal|12
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MoreLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MoreLikeThisQuery
name|mltQuery
init|=
operator|(
name|MoreLikeThisQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMoreLikeFields
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getLikeText
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"something"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMinTermFrequency
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMaxQueryTerms
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMoreLikeThis
specifier|public
name|void
name|testMoreLikeThis
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/mlt.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MoreLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MoreLikeThisQuery
name|mltQuery
init|=
operator|(
name|MoreLikeThisQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMoreLikeFields
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMoreLikeFields
argument_list|()
index|[
literal|1
index|]
argument_list|,
name|equalTo
argument_list|(
literal|"name.last"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getLikeText
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"something"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMinTermFrequency
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMaxQueryTerms
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testFuzzyLikeThisBuilder
specifier|public
name|void
name|testFuzzyLikeThisBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|fuzzyLikeThisQuery
argument_list|(
literal|"name.first"
argument_list|,
literal|"name.last"
argument_list|)
operator|.
name|likeText
argument_list|(
literal|"something"
argument_list|)
operator|.
name|maxQueryTerms
argument_list|(
literal|12
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
comment|//        FuzzyLikeThisQuery fuzzyLikeThisQuery = (FuzzyLikeThisQuery) parsedQuery;
block|}
annotation|@
name|Test
DECL|method|testFuzzyLikeThis
specifier|public
name|void
name|testFuzzyLikeThis
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/fuzzyLikeThis.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
comment|//        FuzzyLikeThisQuery fuzzyLikeThisQuery = (FuzzyLikeThisQuery) parsedQuery;
block|}
annotation|@
name|Test
DECL|method|testFuzzyLikeFieldThisBuilder
specifier|public
name|void
name|testFuzzyLikeFieldThisBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|fuzzyLikeThisFieldQuery
argument_list|(
literal|"name.first"
argument_list|)
operator|.
name|likeText
argument_list|(
literal|"something"
argument_list|)
operator|.
name|maxQueryTerms
argument_list|(
literal|12
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
comment|//        FuzzyLikeThisQuery fuzzyLikeThisQuery = (FuzzyLikeThisQuery) parsedQuery;
block|}
annotation|@
name|Test
DECL|method|testFuzzyLikeThisField
specifier|public
name|void
name|testFuzzyLikeThisField
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/fuzzyLikeThisField.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|FuzzyLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
comment|//        FuzzyLikeThisQuery fuzzyLikeThisQuery = (FuzzyLikeThisQuery) parsedQuery;
block|}
annotation|@
name|Test
DECL|method|testMoreLikeThisFieldBuilder
specifier|public
name|void
name|testMoreLikeThisFieldBuilder
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|moreLikeThisFieldQuery
argument_list|(
literal|"name.first"
argument_list|)
operator|.
name|likeText
argument_list|(
literal|"something"
argument_list|)
operator|.
name|minTermFreq
argument_list|(
literal|1
argument_list|)
operator|.
name|maxQueryTerms
argument_list|(
literal|12
argument_list|)
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MoreLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MoreLikeThisQuery
name|mltQuery
init|=
operator|(
name|MoreLikeThisQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMoreLikeFields
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getLikeText
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"something"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMinTermFrequency
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMaxQueryTerms
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testMoreLikeThisField
specifier|public
name|void
name|testMoreLikeThisField
parameter_list|()
throws|throws
name|Exception
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/mltField.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|MoreLikeThisQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|MoreLikeThisQuery
name|mltQuery
init|=
operator|(
name|MoreLikeThisQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMoreLikeFields
argument_list|()
index|[
literal|0
index|]
argument_list|,
name|equalTo
argument_list|(
literal|"name.first"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getLikeText
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"something"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMinTermFrequency
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|mltQuery
operator|.
name|getMaxQueryTerms
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|12
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilterNamed
specifier|public
name|void
name|testGeoDistanceFilterNamed
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter1
specifier|public
name|void
name|testGeoDistanceFilter1
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter2
specifier|public
name|void
name|testGeoDistanceFilter2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter3
specifier|public
name|void
name|testGeoDistanceFilter3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter4
specifier|public
name|void
name|testGeoDistanceFilter4
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance4.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter5
specifier|public
name|void
name|testGeoDistanceFilter5
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance5.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter6
specifier|public
name|void
name|testGeoDistanceFilter6
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance6.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter7
specifier|public
name|void
name|testGeoDistanceFilter7
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance7.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter8
specifier|public
name|void
name|testGeoDistanceFilter8
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance8.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter9
specifier|public
name|void
name|testGeoDistanceFilter9
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance9.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter10
specifier|public
name|void
name|testGeoDistanceFilter10
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance10.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter11
specifier|public
name|void
name|testGeoDistanceFilter11
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance11.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoDistanceFilter12
specifier|public
name|void
name|testGeoDistanceFilter12
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_distance12.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoDistanceFilter
name|filter
init|=
operator|(
name|GeoDistanceFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|distance
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|12
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoBoundingBoxFilterNamed
specifier|public
name|void
name|testGeoBoundingBoxFilterNamed
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_boundingbox-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|InMemoryGeoBoundingBoxFilter
name|filter
init|=
operator|(
name|InMemoryGeoBoundingBoxFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoBoundingBoxFilter1
specifier|public
name|void
name|testGeoBoundingBoxFilter1
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_boundingbox1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|InMemoryGeoBoundingBoxFilter
name|filter
init|=
operator|(
name|InMemoryGeoBoundingBoxFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoBoundingBoxFilter2
specifier|public
name|void
name|testGeoBoundingBoxFilter2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_boundingbox2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|InMemoryGeoBoundingBoxFilter
name|filter
init|=
operator|(
name|InMemoryGeoBoundingBoxFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoBoundingBoxFilter3
specifier|public
name|void
name|testGeoBoundingBoxFilter3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_boundingbox3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|InMemoryGeoBoundingBoxFilter
name|filter
init|=
operator|(
name|InMemoryGeoBoundingBoxFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoBoundingBoxFilter4
specifier|public
name|void
name|testGeoBoundingBoxFilter4
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_boundingbox4.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|InMemoryGeoBoundingBoxFilter
name|filter
init|=
operator|(
name|InMemoryGeoBoundingBoxFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|topLeft
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|bottomRight
argument_list|()
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoPolygonNamedFilter
specifier|public
name|void
name|testGeoPolygonNamedFilter
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_polygon-named.json"
argument_list|)
decl_stmt|;
name|ParsedQuery
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|namedFilters
argument_list|()
operator|.
name|containsKey
argument_list|(
literal|"test"
argument_list|)
argument_list|,
name|equalTo
argument_list|(
literal|true
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
operator|.
name|query
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
operator|.
name|query
argument_list|()
decl_stmt|;
name|GeoPolygonFilter
name|filter
init|=
operator|(
name|GeoPolygonFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|20
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|90
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoPolygonFilter1
specifier|public
name|void
name|testGeoPolygonFilter1
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_polygon1.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoPolygonFilter
name|filter
init|=
operator|(
name|GeoPolygonFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|20
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|90
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoPolygonFilter2
specifier|public
name|void
name|testGeoPolygonFilter2
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_polygon2.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoPolygonFilter
name|filter
init|=
operator|(
name|GeoPolygonFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|20
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|90
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoPolygonFilter3
specifier|public
name|void
name|testGeoPolygonFilter3
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_polygon3.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoPolygonFilter
name|filter
init|=
operator|(
name|GeoPolygonFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|20
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|90
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoPolygonFilter4
specifier|public
name|void
name|testGeoPolygonFilter4
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geo_polygon4.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|GeoPolygonFilter
name|filter
init|=
operator|(
name|GeoPolygonFilter
operator|)
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|fieldName
argument_list|()
argument_list|,
name|equalTo
argument_list|(
literal|"location"
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
operator|.
name|length
argument_list|,
name|equalTo
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|40
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|0
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|70
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|30
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|1
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|80
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lat
argument_list|()
argument_list|,
name|closeTo
argument_list|(
literal|20
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
name|assertThat
argument_list|(
name|filter
operator|.
name|points
argument_list|()
index|[
literal|2
index|]
operator|.
name|lon
argument_list|()
argument_list|,
name|closeTo
argument_list|(
operator|-
literal|90
argument_list|,
literal|0.00001
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoShapeFilter
specifier|public
name|void
name|testGeoShapeFilter
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geoShape-filter.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|XConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|XConstantScoreQuery
name|constantScoreQuery
init|=
operator|(
name|XConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|constantScoreQuery
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|RecursivePrefixTreeFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|testGeoShapeQuery
specifier|public
name|void
name|testGeoShapeQuery
parameter_list|()
throws|throws
name|IOException
block|{
name|IndexQueryParserService
name|queryParser
init|=
name|queryParser
argument_list|()
decl_stmt|;
name|String
name|query
init|=
name|copyToStringFromClasspath
argument_list|(
literal|"/org/elasticsearch/test/unit/index/query/geoShape-query.json"
argument_list|)
decl_stmt|;
name|Query
name|parsedQuery
init|=
name|queryParser
operator|.
name|parse
argument_list|(
name|query
argument_list|)
operator|.
name|query
argument_list|()
decl_stmt|;
name|assertThat
argument_list|(
name|parsedQuery
argument_list|,
name|instanceOf
argument_list|(
name|ConstantScoreQuery
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
name|ConstantScoreQuery
name|csq
init|=
operator|(
name|ConstantScoreQuery
operator|)
name|parsedQuery
decl_stmt|;
name|assertThat
argument_list|(
name|csq
operator|.
name|getFilter
argument_list|()
argument_list|,
name|instanceOf
argument_list|(
name|RecursivePrefixTreeFilter
operator|.
name|class
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_class

end_unit

